<app-navbar></app-navbar>
<p-toast position="top-right" [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}"></p-toast>
<div class="container">
  <div class="row justify-content-center">
    <div class="overlay">
      <p-progressSpinner *ngIf="blockedDocument" [style]="{width: '150px', height: '150px', margin:'auto'}"
        styleClass="custom-spinner"></p-progressSpinner>
    </div>
  </div>
</div>
<div style="display: flex;">
  <div style="margin: auto;">
    <button (click)="convertirDataPdf()" class="btn btn-dark btn-sm" style="margin: 0px 10px 10px 0;">Descargar Tabla en
      PDF</button>
    <button (click)="exportToExcel()" class="btn btn-dark btn-sm" style="margin-bottom: 10px;">Exportar Datos a
      Excel</button>
  </div>
</div>
<form style="display: flex" [formGroup]="formControl | asFormGroup">

  <div class="table-responsive">
    <table mat-table [dataSource]="dataSource" id="dataPdf" class="table text-center table-sm">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> No.
          <mat-form-field class="numberCss">
            <input type="number" matInput formControlName="id">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table"> {{element.id}} </td>
      </ng-container>

      <ng-container matColumnDef="revisor">
        <th mat-header-cell *matHeaderCellDef> Creador de la Actividad
          <mat-form-field>
            <input matInput formControlName="revisor">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table"> {{element.revisor}} </td>
      </ng-container>

      <ng-container matColumnDef="proyecto">
        <th mat-header-cell *matHeaderCellDef> Proyecto
          <mat-form-field>
            <input matInput formControlName="proyecto">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table">{{element.proyecto}}</td>
      </ng-container>

      <ng-container matColumnDef="tarea">
        <th mat-header-cell *matHeaderCellDef> Actividad
          <mat-form-field>
            <input matInput formControlName="tarea">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table">{{element.tarea}}</td>
      </ng-container>

      <ng-container matColumnDef="tareaIndicadors">
        <th mat-header-cell *matHeaderCellDef style="display: flex;width: 400px;padding: 0;margin: 0;"><span
            style="margin: auto;">Indicadores de Actividad</span>
        </th>
        <td mat-cell *matCellDef="let element" style="min-width: 400px;" class="body-table">
          <span *ngFor="let indicador of element.tareaIndicadors; index as i">
            <br *ngIf="i!=0">
            <b>{{ i+1}}.-</b>
            <span *ngIf="indicador.descripcionTareaIndicador!=''"><b> {{
                indicador.descripcionTareaIndicador}}: </b></span>
            <span *ngIf="!indicador.descripcionTareaIndicador"><b>{{
                indicador.valorIndicador}} </b></span>
            <span
              *ngIf="indicador.descripcionTareaIndicador && indicador.indicadorCODIGOINDICADOR.nombreIndicador=='PORCENTAJE'">{{
              indicador.valorIndicador}} %</span>
            <span
              *ngIf="indicador.descripcionTareaIndicador && indicador.indicadorCODIGOINDICADOR.nombreIndicador!='PORCENTAJE'">{{
              indicador.valorIndicador}} </span>
          </span>
        </td>
      </ng-container>

      <ng-container matColumnDef="fechaInicio">
        <th mat-header-cell *matHeaderCellDef> fecha de Inicio
          <mat-form-field>
            <input matInput formControlName="fechaInicio">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table"> {{element.fechaInicio |
          date:"short":'+00:00'}} </td>
      </ng-container>

      <ng-container matColumnDef="fechaVencimiento">
        <th mat-header-cell *matHeaderCellDef> fecha de Vencimiento
          <mat-form-field>
            <input matInput formControlName="fechaVencimiento">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table">
          <span *ngIf="element.fechaVencimiento">{{element.fechaVencimiento|
            date:"short":'+00:00'}} </span>
          <span *ngIf="!element.fechaVencimiento">No aplica</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="responsable">
        <th mat-header-cell *matHeaderCellDef> Persona Responsable de la Tarea
          <mat-form-field>
            <input matInput formControlName="responsable">
            <mat-placeholder class="color-input"></mat-placeholder>
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element" class="body-table"> {{element.responsable}} </td>
      </ng-container>

      <ng-container matColumnDef="pdf">
        <th mat-header-cell *matHeaderCellDef> PDF </th>
        <td mat-cell *matCellDef="let element" class="body-table">
          <a href="{{element.urlArchivo}}">{{element.nombreArchivo}}</a>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]= "[5, 10, 20,100]"
                 showFirstLastButtons
                 aria-label = "Seleccionar página de elementos periódicos"> </mat-paginator>
  </div>
</form>
<!--<div class="container">
  <div class="card">
    <div class="card-header">
      <h3>Tareas por Revisar</h3>
    </div>
    <div class="card-body">
      <table id="datos" class="table table-hover text-center">
        <thead>
          <tr>
            <th>{{sum + 1}}</th>
            <th>Creado <input type="text" class="search form-control-sm form-control" busqueda="buscador_nombre_creador"/></th>
            <th>Proceso <input type="text" class="search form-control-sm form-control" busqueda="buscador_proceso"/></th>
            <th>Proyecto <input type="text" class="search form-control-sm form-control" busqueda="buscador_proyecto"/></th>
            <th>Tarea <input type="text" class="search form-control-sm form-control" busqueda="buscador_tarea"/></th>
            <th>Prioridad <input type="text" class="search form-control-sm form-control" busqueda="buscador_prioridad"/></th>
            <th>Peso <input type="text" class="search form-control-sm form-control" busqueda="buscador_peso"/></th>
            <th>Fecha de Inicio <input type="text" class="search form-control-sm form-control" busqueda="buscador_fecha_inicio"/></th>
            <th>Fecha de Vencimiento <input type="text" class="search form-control-sm form-control" busqueda="buscador_fecha_vencimiento"/></th>

            <th>Responsable <input type="text" class="search form-control-sm form-control" busqueda="buscador_responsable"/></th>
            <th>Evidencia</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let tarea of tareasDocente">
            <td>{{sum + 1}}</td>
            <td class="buscador_nombre_creador">{{ tarea.codigoTarea?.nombreDocenteRevisor }}</td>
            <td class="buscador_proceso">{{ tarea.codigoTarea?.codigoProyecto?.tipoProceso?.nombreTipoProceso }}</td>
            <td class="buscador_proyecto">{{ tarea.codigoTarea?.codigoProyecto?.nombreProyecto }}</td>
            <td class="buscador_tarea">{{ tarea.codigoTarea?.nombreTarea }}</td>
            <td class="buscador_prioridad">{{ tarea.codigoTarea?.prioridadTarea }}</td>
            <td class="buscador_peso">{{ tarea.codigoTarea?.valorPesoTarea }} {{ tarea.codigoTarea?.pesoTarea }} </td>
            <td class="buscador_fecha_inicio">{{ tarea.codigoTarea?.fechaCreaciontarea | date:"short":'+00:00' }}</td>
            <td class="buscador_fecha_vencimiento">{{ tarea.codigoTarea?.fechaEntregaTarea | date:"short":'+00:00' }}</td>
            <td class="buscador_responsable">{{ tarea.codigoDocente?.nombreDocente }} {{ tarea.codigoDocente?.apellidoDocente }} </td>
            <td *ngIf="tarea.codigoTarea?.nombreArchivoTarea!=null || tarea.codigoTarea?.nombreArchivoTarea!=''">
              <mat-icon>picture_as_pdf</mat-icon>
              <a href="" style="text-decoration: none;">{{tarea.nombreArchivoTareaDocente}}</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
-->
